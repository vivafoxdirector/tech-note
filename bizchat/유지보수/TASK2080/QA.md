# QA
# 20210104
- 딜러사/중계사의 개념
- 각 권한별 Admin 계정 아이디/비번은 어떻게 되는가? 테스트시 필요함. 

# 20210107

중계사 개념이 모호 하다. 아래는 유매니저님과 금일 통화한 내용을 정리한다.
## 중계사
상담비즈챗 중계사 따로
설문(마케팅)비즈챗 중계사 따로

참고) Admin > SuperAdmin로그인 > 메시지관리&통계 > 설문 이력 조회 > 중계사 콤보(5개가 나옴)
이중 4개(SKT제외)는 설문중계사이고, SKT는 상담중계사라고 한다. 

위의 개념들과 함께 고민이 되어야 한다.

## 영향도 화면
비지니스 오너 = 사업자  로 간주한다.
사업자(비지니스 오너)개념이 추가시 영향도가 있는 항목을 아래와 같이 정리
1. 통계
화면: 메시지관리 &통계 > 상담 비즈챗 > 설문이력조회
화면: 메시지관리 &통계 > 마케팅 비즈챗 > 설문이력조회
통계(비지니스 오너별로)

2. 고객사 관리
고객사 관리(비지니스 오너가 생김)
3. 운영관리
운영관리(비지니스오너가 생김)
4. 서비스 관리
서비스관리(슈퍼어드민)
-> 설문관리(비지니스오너가 생김)만 SKT /SKT DATA/ SKT B2B 중계사가 생기되.. 비지니스 오너가 다를것이다.
RLC테이블을 사용하는 테이블은 비지니스 오너 개념이 필요한지... 파악

알림비즈챗, 마케팅비즈챗에는 화면은 나오더라도 아무것도 조회가 되지 않게 하면 된다.

# 20210113
1. 오비즈Admin 메뉴 항목 관련해서 질문입니다. 로그인시 메뉴항목들은 어떻게 처리되는지 잠깐 확인을 해보았습니다.
SuperAdmin권한으로 로그인했을경우(roleid: 51) 화면에 표시할 메뉴항목을 rsrc 테이블에서 조회해서 topMenu.jsp에 결과를 전송하여 메뉴를 표시하는듯합니다. 아래는 SuperAdmin의 roleid: 51 인경우 메뉴항목을 가져오는 쿼리입니다. …. (중략)

그렇다면 이번 Admin권한 보완에 관련하여 작업이 되어야 할 것이 role id 추가 rsrc 테이블에 해당 role id에 따른 접근 할 수 있는 메뉴항목이 결과로 나와야 하는듯 보입니다. '사업자Admin'을 기존 SKT Admin (roleid: 52)로 대체해도 된다면 이것을 이용하는 방법을 고려하겠습니다.

=> '사업자Admin'을 기존 SKT Admin (roleid: 52)로 대체해도 된다면이 아니라, 기존 SKT Admin이 사업자 Admin으로 바뀌는 것입니다. 사업자 Admin은 기존 SKT Admin 과는 달리 자신에게 속한 중계사(RLC 테이블에 등록된 중계사)이하 딜러사/고객사의 데이터만 관리/조회할 수 있습니다.

  => 오비즈Admin전용 'SuperAdmin'과 '사업자 Admin' 2개의 계정에 대한 role 테이블에 roleid 를 각각 새로 발행하고, 새로 발행한 roleid를 이용하여 rsrc/role_rsrc_mapp 테이블에 오비즈용 정보(메뉴정보)를 insert 하는 방법(수동 insert)으로 생각하고 있습니다.  (메뉴 항목도 DB에서 조회를 하기때문에.. 오비즈Admin경우 오비즈에 맞는 메뉴가 조회되려면 rsrc테이블에 해당 내용이 저장되어 있어야 함)

2. 만일 위와 같이 Admin에 대한 메뉴 항목을 DB조회해서 들고 온다면 오비즈Admin 같은 경우는 UI작업보다는 백엔드쿼리 조건으로 처리가 될듯합니다. 이부분이 저가 파악한것이 맞는지요? 물론 파생되는 UI작업 또한 있을수 있어 보입니다
=> 오비즈 Admin은 아래 계획 중이신 BLC 테이블에 등록된 사업에 기반하여 발행하는 Admin 계정으로 ADMIN 테이블에 추가될 BLC_ID 칼럼에 오비즈의 BLC_ID를 가진 ADMIN 사용자를 의미하게 됩니다.
=> 오비즈 ADMIN 사용자를 위한 별도의 Backend 작업은 필요가 없어 보입니다, 위에서 진행할 예정인 SKT Admin을 사업자 Admin로 변경하게 되면, 오비즈 Admin 도 자연스럽게 사업자 Admin 중 하나가 될 것으로 예상됩니다.

그리고 아래 진행예정인, 백엔드 작업에 추가적인 커멘트 드립니다.
- 하나의 중계사(특정 RLC_ID)는 하나의 사업에만 포함될 수 있습니다. 따라서 사업자 Admin이 로그인한 경우에, 기존 Admin 화면 중 중계사/딜러사/고객사를 선택할 수 있는 화면은 변경될 필요가 없습니다. 따라서 해당 화면이 연관된 SQL 쿼리들도 해당 화면이 보여질 때 선택버튼에 나타나는 해당 사업자에 소속된 중계사/딜러사/고객사 내용을 조회하는 공통 QUERY를 빼고는 화면과 동일하게 손댈 필요가 없는 것으로 보입니다.
- 기존 통계들도 중계사/딜러사/고객사별로 계산하도록 되어 있습니다. 이들을 하나로 묶어주는 사업자(BLC) 통계 조회 QUERY를 추가하면 되는 것이지, 기존의 중계사변/딜러사별/고객사별 통계를 변경하는 것은 아닌 것으로 보입니다.
- 지난주에는 너무 좁게 이번에는 너무 넓게 수정범위를 보고 계신 것으로 보여서 말씀 드리는 겁니다.
- 제가 위에 말씀 드린 내용이 맞다면, 차주까지는 대부분의 Admin Web작업들이 종료되어야 하는 것으로 보입니다.
- 우선 금주까지 ERD 변경을 끝내주시고, 제게 작업요청서 전달 해주시기 바랍니다.

# 20210118
## 요청(from SKP)
아래 추가 요청하신 테이블 말고도 RSRC 및 ROLE_RSRC_MAPP 테이블도 제 생각에는 사업자 구분이 필요할 것으로 생각됩니다.
오비즈 같은 경우는 공통 및 마케팅 비즈챗에 관련된 자원만 유효하기 때문입니다.

## 재문의
1. 오비즈Admin 메뉴 항목 관련해서 질문입니다. 로그인시 메뉴항목들은 어떻게 처리되는지 잠깐 확인을 해보았습니다.
SuperAdmin권한으로 로그인했을경우(roleid: 51) 화면에 표시할 메뉴항목을 rsrc 테이블에서 조회해서 topMenu.jsp에 결과를 전송하여 메뉴를 표시하는듯합니다. 아래는 SuperAdmin의 roleid: 51 인경우 메뉴항목을 가져오는 쿼리입니다. …. (중략)

그렇다면 이번 Admin권한 보완에 관련하여 작업이 되어야 할 것이 role id 추가 rsrc 테이블에 해당 role id에 따른 접근 할 수 있는 메뉴항목이 결과로 나와야 하는듯 보입니다. '사업자Admin'을 기존 SKT Admin (roleid: 52)로 대체해도 된다면 이것을 이용하는 방법을 고려하겠습니다.
=> '사업자Admin'을 기존 SKT Admin (roleid: 52)로 대체해도 된다면이 아니라, 기존 SKT Admin이 사업자 Admin으로 바뀌는 것입니다. 사업자 Admin은 기존 SKT Admin 과는 달리 자신에게 속한 중계사(RLC 테이블에 등록된 중계사)이하 딜러사/고객사의 데이터만 관리/조회할 수 있습니다.

  => 오비즈Admin전용 'SuperAdmin'과 '사업자 Admin' 2개의 계정에 대한 role 테이블에 roleid 를 각각 새로 발행하고, 새로 발행한 roleid를 이용하여 rsrc/role_rsrc_mapp 테이블에 오비즈용 정보(메뉴정보)를 insert 하는 방법(수동 insert)으로 생각하고 있습니다.  (메뉴 항목도 DB에서 조회를 하기때문에.. 오비즈Admin경우 오비즈에 맞는 메뉴가 조회되려면 rsrc테이블에 해당 내용이 저장되어 있어야 함)

## 답변(from SKP)
Resource-Role-Mapping을 구분하지 않고 ROLE을 “오비즈 Admin”, “비즈챗 Admin”, “B2B Admin” 등과 같이 특정 비즈니스에 종속적으로 여러개의 Role들로 구분해서 사용하셔도 됩니다.

기존에 생각하신 대로 우선 추진하시고, 혹시나 어려운 문제가 발생하면 Resource-Role-Mapping에 blc_id 를 추가하는 방안을 차선으로 고려하시기 바랍니다.

COM_CD에 blc_id 추가 여부는 금일 중으로 빠르게 결정 해주시기 바랍니다.

